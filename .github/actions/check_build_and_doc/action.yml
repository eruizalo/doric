name: "Check, build & doc ğŸ¯"
description: "Check the code, build, testing & generate project documentation"

inputs:
  testing:
    description: 'Whether to execute tests or not'
    required: true
    default: true

runs:
  using: "composite"
  steps:
    - uses: olafurpg/setup-scala@v13
    - uses: coursier/cache-action@v6
    - name: Code Format ğŸ”
      if: inputs.testing == true
      run: sbt scalafmtCheckAll
    - name: Test & coverage ğŸ“‹
      if: inputs.testing == true
      run: sbt coverage core/test coverageReport coverageAggregate
    - name: Publish coverage to codecov ğŸ“Š
      if: inputs.testing == true
      uses: codecov/codecov-action@v2
      with:
        files: ./target/scala-2.12/scoverage-report/scoverage.xml
        fail_ci_if_error: true
        verbose: false
    - name: Build the microsite ğŸ’»
      run: sbt docs/mdoc
    - name: Build the scaladocs ğŸ’»
      run: sbt core/doc
